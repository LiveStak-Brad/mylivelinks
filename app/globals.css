@tailwind base;
@tailwind components;
@tailwind utilities;

@import '../styles/gift-animations.css';

/* ============================================================================
   GLOBAL THEME TOKENS - Single Source of Truth
   ============================================================================
   Using HSL values for easy manipulation. Access via:
   - CSS: hsl(var(--primary))
   - Tailwind: bg-primary, text-primary-foreground, etc.
   ============================================================================ */

@layer base {
  :root {
    /* Base colors - Light mode */
    --background: 0 0% 100%;
    --foreground: 222 47% 11%;
    
    /* Card/Panel backgrounds */
    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;
    
    /* Popover/Dropdown backgrounds */
    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;
    
    /* Primary brand color - Purple gradient base */
    --primary: 262 83% 58%;
    --primary-foreground: 0 0% 100%;
    
    /* Secondary - Muted purple */
    --secondary: 262 30% 96%;
    --secondary-foreground: 262 47% 25%;
    
    /* Muted backgrounds for subtle elements */
    --muted: 220 14% 96%;
    --muted-foreground: 220 9% 46%;
    
    /* Accent - Pink/Magenta for highlights */
    --accent: 330 81% 60%;
    --accent-foreground: 0 0% 100%;
    
    /* Destructive/Error - Red */
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    
    /* Success - Green */
    --success: 142 71% 45%;
    --success-foreground: 0 0% 100%;
    
    /* Warning - Amber */
    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 0%;
    
    /* Borders */
    --border: 220 13% 91%;
    --input: 220 13% 91%;
    
    /* Focus ring */
    --ring: 262 83% 58%;
    
    /* Border radius */
    --radius: 0.75rem;
    
    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  }

  .dark {
    /* Base colors - Dark mode */
    --background: 222 47% 6%;
    --foreground: 210 40% 98%;
    
    /* Card/Panel backgrounds */
    --card: 222 47% 9%;
    --card-foreground: 210 40% 98%;
    
    /* Popover/Dropdown backgrounds */
    --popover: 222 47% 9%;
    --popover-foreground: 210 40% 98%;
    
    /* Primary brand color - Brighter purple for dark mode */
    --primary: 262 83% 65%;
    --primary-foreground: 0 0% 100%;
    
    /* Secondary */
    --secondary: 222 47% 14%;
    --secondary-foreground: 210 40% 98%;
    
    /* Muted */
    --muted: 222 47% 14%;
    --muted-foreground: 215 20% 65%;
    
    /* Accent - Pink/Magenta */
    --accent: 330 81% 65%;
    --accent-foreground: 0 0% 100%;
    
    /* Destructive/Error */
    --destructive: 0 62% 55%;
    --destructive-foreground: 0 0% 100%;
    
    /* Success */
    --success: 142 71% 50%;
    --success-foreground: 0 0% 100%;
    
    /* Warning */
    --warning: 38 92% 55%;
    --warning-foreground: 0 0% 0%;
    
    /* Borders */
    --border: 222 47% 18%;
    --input: 222 47% 18%;
    
    /* Focus ring */
    --ring: 262 83% 65%;
    
    /* Shadows - More subtle in dark mode */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
    --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.4), 0 1px 2px -1px rgb(0 0 0 / 0.3);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4), 0 2px 4px -2px rgb(0 0 0 / 0.3);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.4), 0 4px 6px -4px rgb(0 0 0 / 0.3);
  }
}

@layer base {
  * {
    @apply border-border;
  }
  
  body {
    @apply bg-background text-foreground antialiased;
    font-feature-settings: "rlig" 1, "calt" 1;
  }

  html {
    scroll-behavior: smooth;
  }
}

/* ============================================================================
   COMPONENT LAYER - Reusable component styles
   ============================================================================ */

@layer components {
  /* Focus ring utility */
  .focus-ring {
    @apply outline-none ring-2 ring-ring ring-offset-2 ring-offset-background;
  }
  
  /* Card base style */
  .card {
    @apply rounded-xl border border-border bg-card text-card-foreground;
    box-shadow: var(--shadow);
  }
  
  /* Input base style */
  .input-base {
    @apply flex h-10 w-full rounded-lg border border-input bg-background px-3 py-2 text-sm 
           placeholder:text-muted-foreground 
           focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background
           disabled:cursor-not-allowed disabled:opacity-50;
  }
  
  /* Button base variants */
  .btn {
    @apply inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium 
           transition-all duration-200 
           focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background
           disabled:pointer-events-none disabled:opacity-50;
  }
  
  .btn-sm { @apply h-8 px-3 text-xs; }
  .btn-md { @apply h-10 px-4 py-2; }
  .btn-lg { @apply h-12 px-6 text-base; }
  
  .btn-primary {
    @apply bg-primary text-primary-foreground hover:bg-primary/90 active:bg-primary/80;
  }
  
  .btn-secondary {
    @apply bg-secondary text-secondary-foreground hover:bg-secondary/80 active:bg-secondary/70;
  }
  
  .btn-ghost {
    @apply hover:bg-muted hover:text-foreground;
  }
  
  .btn-destructive {
    @apply bg-destructive text-destructive-foreground hover:bg-destructive/90 active:bg-destructive/80;
  }
  
  .btn-outline {
    @apply border border-input bg-background hover:bg-muted hover:text-foreground;
  }
  
  .btn-link {
    @apply text-primary underline-offset-4 hover:underline;
  }
  
  /* Badge variants */
  .badge {
    @apply inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors;
  }
  
  .badge-default {
    @apply bg-secondary text-secondary-foreground;
  }
  
  .badge-primary {
    @apply bg-primary/10 text-primary;
  }
  
  .badge-success {
    @apply bg-success/10 text-success;
  }
  
  .badge-warning {
    @apply bg-warning/10 text-warning;
  }
  
  .badge-destructive {
    @apply bg-destructive/10 text-destructive;
  }
  
  /* Table styles */
  .table-container {
    @apply overflow-hidden rounded-xl border border-border;
  }
  
  .table-header {
    @apply bg-muted/50;
  }
  
  .table-row {
    @apply border-b border-border hover:bg-muted/50 transition-colors;
  }
  
  .table-cell {
    @apply px-4 py-3 text-sm;
  }
}

/* ============================================================================
   UTILITIES
   ============================================================================ */

@layer utilities {
  /* Glass effect */
  .glass {
    @apply bg-background/80 backdrop-blur-lg;
  }
  
  /* Gradient text */
  .gradient-text {
    @apply bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent;
  }
  
  /* Brand gradient backgrounds */
  .gradient-primary {
    @apply bg-gradient-to-r from-primary to-accent;
  }
  
  .gradient-primary-subtle {
    @apply bg-gradient-to-r from-primary/10 to-accent/10;
  }
}

/* ============================================================================
   CUSTOM SCROLLBAR
   ============================================================================ */

.custom-scrollbar::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: hsl(var(--muted-foreground) / 0.3);
  border-radius: 3px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--muted-foreground) / 0.5);
}

/* Hide scrollbar but keep functionality */
.scrollbar-hidden {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.scrollbar-hidden::-webkit-scrollbar {
  display: none;
}

/* ============================================================================
   ANIMATIONS
   ============================================================================ */

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slide-up {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes slide-down {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes scale-in {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

.animate-fade-in {
  animation: fade-in 0.2s ease-out;
}

.animate-slide-up {
  animation: slide-up 0.3s ease-out;
}

.animate-slide-down {
  animation: slide-down 0.3s ease-out;
}

.animate-scale-in {
  animation: scale-in 0.2s ease-out;
}

/* ============================================================================
   GIFTER BADGE - DIAMOND TIER ANIMATIONS
   ============================================================================
   Diamond tier has a subtle shimmer animation with soft glow.
   Respects "prefers-reduced-motion" for accessibility.
   ============================================================================ */

/* Shimmer keyframes - subtle light sweep across badge */
@keyframes diamond-shimmer {
  0% {
    background-position: -200% center;
  }
  100% {
    background-position: 200% center;
  }
}

/* Soft pulse glow for diamond */
@keyframes diamond-glow-pulse {
  0%, 100% {
    box-shadow: 0 0 8px rgba(34, 211, 238, 0.4), 
                0 0 16px rgba(34, 211, 238, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }
  50% {
    box-shadow: 0 0 12px rgba(34, 211, 238, 0.6), 
                0 0 24px rgba(34, 211, 238, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
  }
}

/* Diamond badge styling with shimmer and glow */
.gifter-badge-diamond {
  position: relative;
  overflow: hidden;
  animation: diamond-glow-pulse 3s ease-in-out infinite;
}

/* Shimmer overlay pseudo-element */
.gifter-badge-diamond::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(255, 255, 255, 0.15) 45%,
    rgba(255, 255, 255, 0.3) 50%,
    rgba(255, 255, 255, 0.15) 55%,
    transparent 100%
  );
  background-size: 200% 100%;
  animation: diamond-shimmer 4s ease-in-out infinite;
  pointer-events: none;
  border-radius: inherit;
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  .gifter-badge-diamond {
    animation: none;
    box-shadow: 0 0 10px rgba(34, 211, 238, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }
  
  .gifter-badge-diamond::before {
    animation: none;
    background: rgba(255, 255, 255, 0.1);
  }
}

/* ============================================================================
   MOBILE WEB SPECIFIC STYLES
   ============================================================================ */

/* Slow spin animation for rotate overlay */
@keyframes spin-slow {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.animate-spin-slow {
  animation: spin-slow 3s linear infinite;
}

/* Slow pulse animation */
@keyframes pulse-slow {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

.animate-pulse-slow {
  animation: pulse-slow 2s ease-in-out infinite;
}

/* Mobile web video container - ensure full viewport usage */
.mobile-video-container {
  position: fixed;
  inset: 0;
  background: #000;
  z-index: 9998;
}

/* Safe area handling for notched phones */
@supports (padding: max(0px)) {
  .mobile-safe-top {
    padding-top: max(0.5rem, env(safe-area-inset-top));
  }
  
  .mobile-safe-bottom {
    padding-bottom: max(0.75rem, env(safe-area-inset-bottom));
  }
  
  .mobile-safe-left {
    padding-left: max(0.5rem, env(safe-area-inset-left));
  }
  
  .mobile-safe-right {
    padding-right: max(0.5rem, env(safe-area-inset-right));
  }
}

/* Prevent iOS rubber-banding on mobile watch layout */
.mobile-no-bounce {
  overscroll-behavior: none;
  -webkit-overflow-scrolling: auto;
}

/* Mobile video grid aspect ratio handling */
.mobile-video-grid {
  display: grid;
  height: 100%;
  width: 100%;
  align-content: center;
  justify-content: center;
}

/* Hide scrollbars on mobile video grid */
.mobile-video-grid::-webkit-scrollbar {
  display: none;
}

/* Touch-friendly hit targets for mobile buttons */
.mobile-touch-target {
  min-height: 44px;
  min-width: 44px;
}

/* ============================================================================
   iOS PWA STANDALONE MODE OPTIMIZATIONS
   ============================================================================
   When the app is "Added to Home Screen" on iOS, it runs in standalone mode.
   These styles handle safe areas, keyboard, and other iOS-specific quirks.
   ============================================================================ */

/* Detect iOS standalone mode */
@media all and (display-mode: standalone) {
  /* Full height without address bar */
  html, body {
    height: 100%;
    overflow: hidden;
  }
  
  /* Fix for iOS keyboard pushing content */
  body {
    position: fixed;
    width: 100%;
  }
}

/* iOS safe area utilities for PWA */
.pwa-safe-top {
  padding-top: env(safe-area-inset-top, 0px);
}

.pwa-safe-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.pwa-safe-left {
  padding-left: env(safe-area-inset-left, 0px);
}

.pwa-safe-right {
  padding-right: env(safe-area-inset-right, 0px);
}

.pwa-safe-all {
  padding-top: env(safe-area-inset-top, 0px);
  padding-bottom: env(safe-area-inset-bottom, 0px);
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
}

/* iOS keyboard-aware input container */
.ios-keyboard-aware {
  /* This element sticks to bottom, above keyboard */
  position: sticky;
  bottom: 0;
  padding-bottom: env(safe-area-inset-bottom, 0px);
  background: inherit;
}

/* Full height container that respects safe areas */
.pwa-full-height {
  min-height: 100vh;
  min-height: -webkit-fill-available;
  min-height: 100dvh;
}

/* Messages container that accounts for keyboard */
.pwa-messages-container {
  height: 100%;
  height: 100dvh;
  display: flex;
  flex-direction: column;
}

/* Scrollable messages area */
.pwa-messages-scroll {
  flex: 1;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* Fixed input at bottom with safe area */
.pwa-input-area {
  flex-shrink: 0;
  padding-bottom: max(12px, env(safe-area-inset-bottom));
}

/* Prevent rubber-banding on iOS */
.pwa-no-overscroll {
  overscroll-behavior: none;
  -webkit-overflow-scrolling: auto;
}

/* iOS notch-aware header */
.pwa-header {
  padding-top: max(12px, env(safe-area-inset-top));
}

/* Landscape-only media query helper */
@media (orientation: landscape) and (max-width: 900px) {
  .mobile-landscape-only {
    display: block;
  }
  .mobile-portrait-only {
    display: none;
  }
}

@media (orientation: portrait) and (max-width: 900px) {
  .mobile-landscape-only {
    display: none;
  }
  .mobile-portrait-only {
    display: block;
  }
}
