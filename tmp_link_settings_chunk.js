(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5163],{61469:function(e,t,r){Promise.resolve().then(r.bind(r,44948))},44948:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r(57437),i=r(2265),o=r(99376),s=r(13600);function a(){let e=(0,o.useRouter)(),[t,r]=(0,i.useState)({auto_link_on_follow:!1,auto_link_require_approval:!1,auto_link_policy:"everyone"}),[a,l]=(0,i.useState)(!0),[c,u]=(0,i.useState)(!1),[d,f]=(0,i.useState)(null);(0,i.useEffect)(()=>{_()},[]);let _=async()=>{l(!0),f(null);try{let e=await s.h2();e&&r(e)}catch(e){console.error("Failed to load settings:",e),f("Failed to load settings.")}finally{l(!1)}},p=async()=>{u(!0),f(null);try{await s.yw({auto_link_on_follow:t.auto_link_on_follow||!1,auto_link_require_approval:t.auto_link_require_approval||!1,auto_link_policy:t.auto_link_policy||"everyone"}),setTimeout(()=>{e.push("/link")},1e3)}catch(e){console.error("Failed to save settings:",e),f("Failed to save settings.")}finally{u(!1)}};return a?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading settings..."})]})}):(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-28",children:[(0,n.jsx)("div",{className:"sticky top-0 z-50 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 shadow-sm",children:(0,n.jsx)("div",{className:"max-w-3xl mx-auto px-4 py-3",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("button",{onClick:()=>e.push("/link"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})})}),(0,n.jsx)("h1",{className:"text-lg font-bold",children:"Link Settings"}),(0,n.jsx)("button",{onClick:p,disabled:c,className:"px-4 py-2 rounded-lg font-semibold text-sm transition-all bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-md disabled:opacity-50",children:c?"Saving...":"Save"})]})})}),(0,n.jsxs)("div",{className:"max-w-3xl mx-auto px-4 py-6",children:[d&&(0,n.jsx)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500 rounded-lg",children:(0,n.jsx)("p",{className:"text-red-800 dark:text-red-200 text-sm font-medium",children:d})}),(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 mb-4 border border-gray-200 dark:border-gray-700",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Auto-Link (F4F)"}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"font-semibold text-base mb-1",children:"Auto-Link Back on Follow"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"When someone follows you, automatically create a mutual link (F4F)."})]}),(0,n.jsx)("button",{onClick:()=>r({...t,auto_link_on_follow:!t.auto_link_on_follow}),className:"relative w-14 h-8 rounded-full transition-colors flex-shrink-0 ".concat(t.auto_link_on_follow?"bg-gradient-to-r from-emerald-600 to-teal-600":"bg-gray-300 dark:bg-gray-700"),children:(0,n.jsx)("div",{className:"absolute top-1 left-1 w-6 h-6 bg-white rounded-full transition-transform shadow-md ".concat(t.auto_link_on_follow?"translate-x-6":"")})})]}),(0,n.jsxs)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between gap-4 opacity-50",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"font-semibold text-base mb-1",children:"Require Approval"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Review auto-link requests before accepting"})]}),(0,n.jsx)("button",{disabled:!0,className:"relative w-14 h-8 rounded-full bg-gray-300 dark:bg-gray-700 flex-shrink-0 cursor-not-allowed",children:(0,n.jsx)("div",{className:"absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-md"})})]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Coming soon"})]})]})]})]})]})}},13600:function(e,t,r){"use strict";r.d(t,{Al:function(){return s},CK:function(){return g},DY:function(){return h},Lh:function(){return l},OE:function(){return f},Rt:function(){return _},cO:function(){return i},h2:function(){return d},ic:function(){return a},jb:function(){return c},kp:function(){return o},lf:function(){return p},yw:function(){return u}});let n=(0,r(2141).e)();async function i(e){let{data:t,error:r}=await n.rpc("rpc_upsert_link_profile",{p_enabled:e.enabled,p_bio:e.bio||null,p_location_text:e.location_text||null,p_photos:e.photos||[],p_tags:e.tags||[]});if(r)throw console.error("Error upserting link profile:",{message:r.message,details:r.details,hint:r.hint,code:r.code}),r;return t}async function o(){var e,t;let{data:r}=await n.auth.getSession();if(!(null==r?void 0:null===(t=r.session)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.id))return null;let{data:i,error:o}=await n.from("link_profiles").select("*").eq("profile_id",r.session.user.id).single();if(o){if("PGRST116"===o.code)return null;throw console.error("Error fetching link profile:",o),o}return i}async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{data:r,error:i}=await n.rpc("rpc_get_link_candidates",{p_limit:e,p_offset:t});if(i)throw console.error("Error fetching link candidates:",i),i;return r||[]}async function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return s(e,t)}async function l(e,t){let{data:r,error:i}=await n.rpc("rpc_submit_link_decision",{p_to_profile_id:e,p_decision:t});if(i)throw console.error("Error submitting link decision:",{message:i.message,details:i.details,hint:i.hint,code:i.code}),i;return r}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{data:r,error:i}=await n.rpc("rpc_get_my_mutuals",{p_limit:e,p_offset:t});if(i)throw console.error("Error fetching mutuals:",i),i;return r||[]}async function u(e){var t,r;let{data:i,error:o}=await n.rpc("rpc_upsert_link_settings",{p_auto_link_on_follow:e.auto_link_on_follow,p_auto_link_require_approval:null!==(t=e.auto_link_require_approval)&&void 0!==t&&t,p_auto_link_policy:null!==(r=e.auto_link_policy)&&void 0!==r?r:"everyone"});if(o)throw console.error("Error upserting link settings:",o),o;return i}async function d(){var e,t;let{data:r}=await n.auth.getSession();if(!(null==r?void 0:null===(t=r.session)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.id))return null;let{data:i,error:o}=await n.from("link_settings").select("*").eq("profile_id",r.session.user.id).single();if(o){if("PGRST116"===o.code)return null;throw console.error("Error fetching link settings:",o),o}return i}async function f(e){let{data:t,error:r}=await n.rpc("rpc_upsert_dating_profile",{p_enabled:e.enabled,p_bio:e.bio||null,p_location_text:e.location_text||null,p_photos:e.photos||[],p_prefs:e.prefs||{}});if(r)throw console.error("Error upserting dating profile:",r),r;return t}async function _(){var e,t;let{data:r}=await n.auth.getSession();if(!(null==r?void 0:null===(t=r.session)||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.id))return null;let{data:i,error:o}=await n.from("dating_profiles").select("*").eq("profile_id",r.session.user.id).single();if(o){if("PGRST116"===o.code)return null;throw console.error("Error fetching dating profile:",o),o}return i}async function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{data:r,error:i}=await n.rpc("rpc_get_dating_candidates",{p_limit:e,p_offset:t});if(i)throw console.error("Error fetching dating candidates:",i),i;return r||[]}async function h(e,t){let{data:r,error:i}=await n.rpc("rpc_submit_dating_decision",{p_to_profile_id:e,p_decision:t});if(i)throw console.error("Error submitting dating decision:",i),i;return r}async function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{data:r,error:i}=await n.rpc("rpc_get_my_dating_matches",{p_limit:e,p_offset:t});if(i)throw console.error("Error fetching dating matches:",i),i;return r||[]}},2141:function(e,t,r){"use strict";r.d(t,{e:function(){return o}});var n=r(4033);let i=null;function o(){let e="https://dfiyrmqobjfsdsgklweg.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRmaXlybXFvYmpmc2RzZ2tsd2VnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzMzUzOTAsImV4cCI6MjA4MTkxMTM5MH0.2oZG3_v0_0elcjLm19b0kk92QCG_yxZ2iieJ2haJzPw";if(!e||!t)throw console.error("Missing Supabase environment variables"),Error("Missing Supabase environment variables: NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY");return i||(i=(0,n.createBrowserClient)(e,t))}},99376:function(e,t,r){"use strict";var n=r(35475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})}},function(e){e.O(0,[4033,2971,2117,1744],function(){return e(e.s=61469)}),_N_E=e.O()}]);